# Trained Models

This folder contains saved Tensor Logic models from examples.

## Example Models (Tracked in Git)

These are core example models kept in version control:

- **family_tree.pt** + **family_tree.json** - Basic family tree embedding model
  - 6 entities, 32-dim embeddings, 2,240 parameters (~11 KB)
  - Relations: parent, grandparent
  - Generated by: `examples/save_load_model.py`

## Generated Models (Not Tracked by Default)

Run any example below to generate the corresponding model:

| Model | Generator | Approach | Description |
|-------|-----------|----------|-------------|
| `family_tree_embedding.pt/json` | `examples/family_tree_embedding.py` | Embedding Learning | Learns embeddings from parent facts, composes grandparent via matrix mult |
| `learnable_composer.pt/json` | `examples/learnable_demo.py` | Learnable Composition | Trains composer to learn grandparent from parent examples |
| `learnable_composer_weights.pt` | `examples/learnable_demo.py` | Composer Weights | GatedMultiHopComposer trained weights (2-hop) |
| `pattern_discovery.pt/json` | `examples/pattern_discovery_demo.py` | Pattern Discovery | Discovers grandparent pattern from parent facts via closure |
| `pattern_discovery_composer_weights.pt` | `examples/pattern_discovery_demo.py` | Composer Weights | Composer trained via self-supervision |
| `predicate_invention.pt/json` | `examples/predicate_invention_demo.py` | Predicate Invention | Embedding space with invented predicates via RESCAL |
| `three_body_kb.pt/json` | `examples/three_body_kb_demo.py` | Real-World KB | Knowledge base extracted and trained from text |

## User Models (Not Tracked)

You can save your own trained models here. They will not be committed to git by default (configured in `.gitignore`).

### Saving Models

```python
from tensorlogic import save_model, export_embeddings

# Binary format (for inference/loading)
save_model(embed_space, 'models/my_model.pt', metadata={'description': '...'})

# JSON format (human-readable)
export_embeddings(embed_space, 'models/my_model.json')
```

### Loading Models

```python
from tensorlogic import load_model, EmbeddingSpace

# Create empty model with correct config
embed_space = EmbeddingSpace(num_objects=100, embedding_dim=64)

# Load saved weights
metadata = load_model(embed_space, 'models/my_model.pt')
```

## Model File Formats

| Format | Purpose | Benefits |
|--------|---------|----------|
| `.pt` | Binary PyTorch checkpoint | Fast loading, preserves exact weights, inference-ready |
| `.json` | JSON export | Human-readable, inspect embeddings, debugging |

## Performance Reference

Training time for family tree (6 objects, 32 dims, 200 epochs):
- Boolean mode: ~0 seconds (no training)
- Embedding learning: ~0.08 seconds
- Composer learning: ~0.45 seconds

See `examples/benchmark_suite.py` for detailed benchmarks on different model sizes.
