======================================================================
Family Tree Reasoning - Embedding Space with Learning
======================================================================

Family members (8 people):
  0: Alice
  1: Bob
  2: Charlie
  3: Diana
  4: Eve
  5: Frank
  6: Grace
  7: Henry

Parent relationships (training data):
  Alice is parent of Bob
  Alice is parent of Charlie
  Bob is parent of Diana
  Bob is parent of Eve
  Charlie is parent of Frank
  Frank is parent of Grace
  Frank is parent of Henry

======================================================================
Training parent relation embedding...
======================================================================
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 0/200 [00:00<?, ?it/s, loss=13.4445]  0%|          | 0/200 [00:00<?, ?it/s, loss=3.6292]   0%|          | 0/200 [00:00<?, ?it/s, loss=0.8879]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.2478]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0782]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0276]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0109]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0047]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0022]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0011]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0006]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0004]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0002]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0001]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0001]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0001]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000]  0%|          | 0/200 [00:00<?, ?it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000] 57%|█████▊    | 115/200 [00:00<00:00, 1141.24it/s, loss=0.0000]100%|██████████| 200/200 [00:00<00:00, 1137.28it/s, loss=0.0000]

======================================================================
Testing learned parent relation:
======================================================================

True relationships (should be ~1.0):
  P(Alice parent of Bob) = 1.0000
  P(Alice parent of Charlie) = 1.0000
  P(Bob parent of Diana) = 1.0000
  P(Bob parent of Eve) = 1.0000
  P(Charlie parent of Frank) = 1.0000

False relationships (should be ~0.0):
  P(Bob parent of Charlie) = 0.1636
  P(Diana parent of Eve) = 0.0000
  P(Alice parent of Frank) = 0.9645

======================================================================
Composing relations: grandparent = parent ∘ parent
======================================================================

Grandparent relationships (inferred):
  P(Alice grandparent of Diana) = 0.0034
  P(Alice grandparent of Eve) = 1.0000
  P(Alice grandparent of Frank) = 1.0000
  P(Charlie grandparent of Grace) = 1.0000
  P(Charlie grandparent of Henry) = 1.0000

======================================================================
Analogical Reasoning:
======================================================================

Known: Alice is parent of Bob
Query: If Alice is similar to Charlie, who might Charlie be parent of?
Answer: Alice (actual: Frank, idx=5)

======================================================================
Similarity Analysis:
======================================================================

Most similar people to Bob:
  Eve: 0.2908
  Grace: 0.2238
  Charlie: -0.0988

Most similar people to Alice:
  Frank: 0.3957
  Grace: 0.3257
  Charlie: 0.3212

======================================================================
All grandparent relationships (threshold=0.5):
======================================================================

Grandparent matrix:
  Alice is grandparent of Eve
  Alice is grandparent of Frank
  Alice is grandparent of Henry
  Bob is grandparent of Charlie
  Charlie is grandparent of Alice
  Charlie is grandparent of Bob
  Charlie is grandparent of Diana
  Charlie is grandparent of Eve
  Charlie is grandparent of Grace
  Charlie is grandparent of Henry
  Diana is grandparent of Alice
  Diana is grandparent of Frank
  Diana is grandparent of Grace
  Diana is grandparent of Henry
  Eve is grandparent of Diana
  Frank is grandparent of Bob
  Frank is grandparent of Eve
  Frank is grandparent of Grace
  Frank is grandparent of Henry
  Grace is grandparent of Alice
  Grace is grandparent of Charlie
  Grace is grandparent of Diana
  Grace is grandparent of Eve
  Grace is grandparent of Frank
  Henry is grandparent of Diana
  Henry is grandparent of Eve

======================================================================
Embedding space reasoning complete!
======================================================================

Key insights:
  - Embeddings learned structure of family tree
  - Composition (grandparent) works via matrix multiplication
  - Analogical reasoning finds similar patterns
  - Low temperature (0.1) gives strict logical reasoning
======================================================================
